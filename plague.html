<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Plague Inc</title>
<style>
  body { background: #111; color: #fff; font-family: sans-serif; text-align: center; }
  canvas { background: #222; display: block; margin: 20px auto; border: 2px solid #555; }
  button { margin: 5px; padding: 10px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>
<h1>Mini Plague Inc</h1>
<p>Green = Healthy, Yellow = Infected, Red = Dead</p>
<p>Points: <span id="points">0</span></p>
<div>
  <button id="resistanceBtn">Resistance</button>
  <button id="transmissionBtn">Transmission</button>
  <button id="symptomsBtn">Symptoms</button>
</div>
<canvas id="gameCanvas" width="600" height="400"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const POP_SIZE = 100;
const INFECTION_RADIUS = 10;
let infectionChance = 0.1;
let deathChance = 0.005;
let resistance = 0.1;

let points = 0;

const population = [];

// Initialize population
for (let i = 0; i < POP_SIZE; i++) {
    population.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        dx: (Math.random() - 0.5) * 1.5,
        dy: (Math.random() - 0.5) * 1.5,
        status: i < 2 ? 'infected' : 'healthy'
    });
}

// Upgrade buttons
document.getElementById('resistanceBtn').onclick = () => resistance += 0.05;
document.getElementById('transmissionBtn').onclick = () => infectionChance += 0.05;
document.getElementById('symptomsBtn').onclick = () => deathChance += 0.005;

function update() {
    for (let p of population) {
        // Move
        p.x += p.dx;
        p.y += p.dy;
        if (p.x < 0 || p.x > canvas.width) p.dx *= -1;
        if (p.y < 0 || p.y > canvas.height) p.dy *= -1;

        if (p.status === 'infected') {
            // Infect nearby healthy people
            for (let other of population) {
                if (other.status === 'healthy') {
                    const dist = Math.hypot(p.x - other.x, p.y - other.y);
                    if (dist < INFECTION_RADIUS && Math.random() < infectionChance * (1 - resistance)) {
                        other.status = 'infected';
                    }
                }
            }
            // Chance of dying
            if (Math.random() < deathChance) {
                p.status = 'dead';
            }
        }
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let p of population) {
        if (p.status === 'healthy') ctx.fillStyle = 'green';
        else if (p.status === 'infected') ctx.fillStyle = 'yellow';
        else ctx.fillStyle = 'red';
        ctx.beginPath();
        ctx.arc(p.x, p.y, 5, 0, Math.PI * 2);
        ctx.fill();
    }
}

// Earn points for infected
setInterval(() => {
    let infectedCount = population.filter(p => p.status === 'infected').length;
    points += infectedCount;
    document.getElementById('points').innerText = points;
}, 3000);

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
