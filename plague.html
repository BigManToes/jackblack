<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Plague Simulation</title>
<style>
  canvas { background: #111; display: block; margin: auto; }
  #stats { text-align: center; color: white; font-family: sans-serif; margin-top: 10px; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="stats"></div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = 800;  // smaller box
canvas.height = 600;

const totalBalls = 6000;
const balls = [];

const deathChance = 0.00005;    // very low â†’ infected last longer
const recoveryChance = 0.002;   // chance to recover per frame

// Ball states: healthy, infected, dead
class Ball {
    constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 1.5;
        this.vy = (Math.random() - 0.5) * 1.5;
        this.state = 'healthy';
    }

    update() {
        if (this.state !== 'dead') {
            this.x += this.vx;
            this.y += this.vy;

            // bounce off walls
            if (this.x <= 0 || this.x >= canvas.width) this.vx *= -1;
            if (this.y <= 0 || this.y >= canvas.height) this.vy *= -1;
        }

        if (this.state === 'infected') {
            // chance to die
            if (Math.random() < deathChance) this.state = 'dead';
            // chance to recover
            else if (Math.random() < recoveryChance) this.state = 'healthy';
        }
    }

    draw() {
        if (this.state === 'healthy') ctx.fillStyle = 'green';
        else if (this.state === 'infected') ctx.fillStyle = 'red';
        else ctx.fillStyle = 'gray';
        ctx.beginPath();
        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);  // tiny balls for many
        ctx.fill();
    }
}

// create balls
for (let i = 0; i < totalBalls; i++) balls.push(new Ball());

// infect 1 random ball at start
balls[Math.floor(Math.random() * balls.length)].state = 'infected';

function update() {
    balls.forEach(b => b.update());

    // handle collisions for infection
    for (let i = 0; i < balls.length; i++) {
        const a = balls[i];
        if (a.state === 'dead') continue;
        for (let j = i + 1; j < balls.length; j++) {
            const b = balls[j];
            if (b.state === 'dead') continue;
            const dx = a.x - b.x;
            const dy = a.y - b.y;
            if (dx*dx + dy*dy < 4) {  // small radius collision
                if ((a.state === 'infected' && b.state === 'healthy') ||
                    (b.state === 'infected' && a.state === 'healthy')) {
                    a.state = b.state = 'infected';
                }
            }
        }
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    balls.forEach(b => b.draw());
}

function showStats() {
    const healthy = balls.filter(b => b.state === 'healthy').length;
    const infected = balls.filter(b => b.state === 'infected').length;
    const dead = balls.filter(b => b.state === 'dead').length;
    document.getElementById('stats').innerText =
        `Healthy: ${healthy} | Infected: ${infected} | Dead: ${dead}`;
}

function loop() {
    update();
    draw();
    showStats();
    requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
